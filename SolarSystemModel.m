
close all; clear; clc

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

radiusSun=695508;
radiusEarth=6371;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Names={'Mercury';'Venus';'Earth';'Mars';'Jupiter';'Saturn';'Neptune'; ...
    'Uranus';'Pluto';'Quaoar';'Ceres';'Makemake';'Sedna';'Halley';'Eris'; ...
    'Haumea';'Gonggong';'Orcus';'Salacia'};

Radius=[2439.4;6052;6371;3389;69911;58232;25362;24622;1188.3;560.5; ...
    469.7;715;498;6;1163;780;615;458;423];

Eccentricity=[0.20563069;0.00677323;0.01671123;0.09341233;0.04839266; ...
    0.05386179;0.00859048;0.04725744;0.250248713478499;0.0410537243716496; ...
    0.0760090265983052;0.161250070199552;0.842617417321335; ...
    0.967142908462304;0.436048651325063;0.194886232664738; ...
    0.499413412928186;0.227010853662474;0.105056906617812];

SemimajorAxis=[0.38709893;0.72333199;1.000001;1.52366231;5.20336301; ...
    9.53667594;30.06992276;19.18916464;39.4450697257358;43.6950548753924; ...
    2.76916514863328;45.4307018016277;484.547637370958;17.8341442925537; ...
    67.8642709151252;43.1822220946001;67.4831409431737;39.1743469862445; ...
    42.2465192323882];

Inclination=[7.00487;3.39471;0;1.85061;1.3053;2.48599187;1.77004347; ...
    0.77263783;17.089000919562;7.98950953498637;10.5940671950662; ...
    28.9834655267991;11.9306853993835;162.262690579161;44.0393085295011; ...
    28.2135444973436;30.6272338125607;20.5923210465828; ...
    23.9215048528366]*(pi/180);

PerihelionLongitude=[77.45645;131.53298;102.94719;336.04084;14.75385; ...
    92.59887831;44.96476227;170.9542763;224.06676;147.451276839043; ...
    73.5976946984418;294.835008420484;311.348433285047;111.332485104517; ...
    151.643672728015;238.779404450682;207.663397995564;72.3108419132169; ...
    312.825969519451]*(pi/180);

AscendingNode=[48.33167;76.68069;-11.26064;49.57854;100.55615; ...
    113.6624245;131.7842257;74.0169250;110.376957955408;188.927264526794; ...
    80.3055309044573;79.6194357150625;144.247660211808;58.4200809765684; ...
    35.9508292384822;122.16280191776;336.857296904527;268.79923056547; ...
    279.899255829667]*(pi/180);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Mean Orbital Elements (J2000 model)
% https://nssdc.gsfc.nasa.gov/planetary/factsheet/

a=SemimajorAxis;
e=Eccentricity;
i=Inclination;
w=PerihelionLongitude;
o=AscendingNode;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

objects=length(Names);
th=0:pi/100:2*pi;

plottedPoints=10000;
M=zeros(plottedPoints,1);
E(1,1,1)=0;
iterations=100;

for t=1:plottedPoints
    M(t)=(2*pi*t)/plottedPoints;
end

for p=1:objects
    for t=1:plottedPoints
        E(p,1,t)=M(t);
        for k=1:iterations-1
            E(p,k+1,t)=M(t) + e(p)*sin(E(p,k,t));
        end
    end
end

x(1,1,1)=0;
y(1,1,1)=0;
z(1,1,1)=0;

for p=1:objects
    for t=1:plottedPoints
        
        x(p,1,t)=a(p)*(cos(E(p,iterations,t)) - e(p));
        y(p,1,t)=a(p)*power((1-power(e(p),2)),0.5)*sin(E(p,iterations,t));
        z(p,1,t)=0;
        
        x(p,2,t)=x(p,1,t)*cos(w(p)) - y(p,1,t)*sin(w(p));
        y(p,2,t)=y(p,1,t)*cos(w(p)) + x(p,1,t)*sin(w(p));
        z(p,2,t)=z(p,1,t);
        
        x(p,3,t)=x(p,2,t);
        y(p,3,t)=y(p,2,t)*cos(i(p));
        z(p,3,t)=y(p,2,t)*sin(i(p));
        
        x(p,4,t)=x(p,3,t)*cos(o(p)) - y(p,3,t)*sin(o(p));
        y(p,4,t)=x(p,3,t)*sin(o(p)) + y(p,3,t)*cos(o(p));
        z(p,4,t)=z(p,3,t);
    end
end

X=squeeze(x(:,4,:)*1.49597870691e+8)';
Y=squeeze(y(:,4,:)*1.49597870691e+8)';
Z=squeeze(z(:,4,:)*1.49597870691e+8)';

X=cat(1,X,X(1,:));
Y=cat(1,Y,Y(1,:));
Z=cat(1,Z,Z(1,:));

Orbits=cat(3,X,Y,Z);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

sednoid=13;
Orbits(:,sednoid,:)=[];

figure('Position',[60,60,800,800],'Resize','off','Color','k'); hold on;
axis off; axis equal;

for i=1:size(Orbits,2)
    
    plot3(Orbits(:,i,1),Orbits(:,i,2),Orbits(:,i,3),'-c');
    
    drawnow;
end

view(45,45); sgtitle('Azimuth 45, Elevation 45','Color','w');

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%





